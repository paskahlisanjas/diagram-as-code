<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="666px" preserveAspectRatio="none" style="width:806px;height:666px;" version="1.1" viewBox="0 0 806 666" width="806px" zoomAndPan="magnify"><defs><filter height="300%" id="f16n9do56um6m1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="326" cy="48.6982" fill="#000000" filter="url(#f16n9do56um6m1)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><path d="M20,161.3042 L20,216.7026 A0,0 0 0 0 20,216.7026 L221,216.7026 A0,0 0 0 0 221,216.7026 L221,193.0034 L241,189.0034 L221,185.0034 L221,171.3042 L211,161.3042 L20,161.3042 A0,0 0 0 0 20,161.3042 " fill="#FBFB77" filter="url(#f16n9do56um6m1)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M211,161.3042 L211,171.3042 L221,171.3042 L211,161.3042 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="26" y="178.3711">Should only affect VA with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="26" y="193.5039">PENDING status to maintain</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="26" y="208.6367">idempotency</text><rect fill="#FEFECE" filter="url(#f16n9do56um6m1)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="241" y="165.0347"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="120" x="251" y="186.1733">Update VA's status</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="150" x="251" y="200.1421">from PENDING to ACTIVE</text><rect fill="#FEFECE" filter="url(#f16n9do56um6m1)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="265.5" y="236.7026"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="101" x="275.5" y="257.8413">Publish event to</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="76" x="275.5" y="271.8101">va-activated</text><polygon fill="#FEFECE" filter="url(#f16n9do56um6m1)" points="270.5,112.9019,381.5,112.9019,393.5,124.9019,381.5,136.9019,270.5,136.9019,258.5,124.9019,270.5,112.9019" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="330" y="147.1123">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="111" x="270.5" y="128.71">VA status is ACTIVE</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="393.5" y="122.3076">no</text><ellipse cx="429.5" cy="124.9019" fill="#FFFFFF" filter="url(#f16n9do56um6m1)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="429.5" cy="124.9019" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><path d="M627,350.3506 L627,404.3154 L607,408.3154 L627,412.3154 L627,466.2803 A0,0 0 0 0 627,466.2803 L784,466.2803 A0,0 0 0 0 784,466.2803 L784,360.3506 L774,350.3506 L627,350.3506 A0,0 0 0 0 627,350.3506 " fill="#FBFB77" filter="url(#f16n9do56um6m1)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M774,350.3506 L774,360.3506 L784,360.3506 L774,350.3506 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="633" y="367.4175">Should be no issue</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="633" y="382.5503">with idempotency,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="633" y="397.6831">but as alternative</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="633" y="412.8159">can also check</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="633" y="427.9487">the record first if the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="633" y="443.0815">risk score is attached</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="633" y="458.2144">already</text><rect fill="#FEFECE" filter="url(#f16n9do56um6m1)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="455" y="384.3467"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="132" x="465" y="405.4854">Check blacklist name</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="119" x="465" y="419.4541">(assess risk score)</text><rect fill="#FEFECE" filter="url(#f16n9do56um6m1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="161" x="450.5" y="486.2803"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="141" x="460.5" y="507.4189">Update VA's risk score</text><rect fill="#FEFECE" filter="url(#f16n9do56um6m1)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="470.5" y="540.249"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="101" x="480.5" y="561.3877">Publish event to</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="480.5" y="575.3564">va-risk-scored</text><ellipse cx="531" cy="619.1865" fill="#FFFFFF" filter="url(#f16n9do56um6m1)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="531" cy="619.1865" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><polygon fill="#FEFECE" filter="url(#f16n9do56um6m1)" points="475.5,304.6401,586.5,304.6401,598.5,316.6401,586.5,328.6401,475.5,328.6401,463.5,316.6401,475.5,304.6401" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="535" y="338.8506">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="111" x="475.5" y="320.4482">VA status is ACTIVE</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="598.5" y="314.0459">no</text><ellipse cx="634.5" cy="316.6401" fill="#FFFFFF" filter="url(#f16n9do56um6m1)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="634.5" cy="316.6401" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="326" x2="326" y1="212.9722" y2="236.7026"/><polygon fill="#A80036" points="322,226.7026,326,236.7026,330,226.7026,326,230.7026" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="326" x2="326" y1="136.9019" y2="165.0347"/><polygon fill="#A80036" points="322,155.0347,326,165.0347,330,155.0347,326,159.0347" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="393.5" x2="418.5" y1="124.9019" y2="124.9019"/><polygon fill="#A80036" points="408.5,120.9019,418.5,124.9019,408.5,128.9019,412.5,124.9019" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.5; stroke-dasharray: 1.0,3.0;" x1="326" x2="326" y1="284.6401" y2="289.6401"/><line style="stroke: #000000; stroke-width: 1.5; stroke-dasharray: 1.0,3.0;" x1="326" x2="531" y1="289.6401" y2="289.6401"/><line style="stroke: #000000; stroke-width: 1.5; stroke-dasharray: 1.0,3.0;" x1="531" x2="531" y1="289.6401" y2="304.6401"/><polygon fill="#000000" points="527,294.6401,531,304.6401,535,294.6401,531,298.6401" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="326" x2="326" y1="58.6982" y2="112.9019"/><polygon fill="#A80036" points="322,102.9019,326,112.9019,330,102.9019,326,106.9019" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="109" x="330" y="80.0029">Receive notification</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="53" x="330" y="92.8076">from CVA</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="531" x2="531" y1="432.2842" y2="486.2803"/><polygon fill="#A80036" points="527,476.2803,531,486.2803,535,476.2803,531,480.2803" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="531" x2="531" y1="520.249" y2="540.249"/><polygon fill="#A80036" points="527,530.249,531,540.249,535,530.249,531,534.249" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="531" x2="531" y1="588.1865" y2="608.1865"/><polygon fill="#A80036" points="527,598.1865,531,608.1865,535,598.1865,531,602.1865" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="531" x2="531" y1="328.6401" y2="384.3467"/><polygon fill="#A80036" points="527,374.3467,531,384.3467,535,374.3467,531,378.3467" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="598.5" x2="623.5" y1="316.6401" y2="316.6401"/><polygon fill="#A80036" points="613.5,312.6401,623.5,316.6401,613.5,320.6401,617.5,316.6401" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="95" x="182.25" y="29.4531">va-created</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="109" x="562.75" y="29.4531">va-activated</text><line style="stroke: #000000; stroke-width: 2.0;" x1="10" x2="10" y1="12.7451" y2="654.5889"/><line style="stroke: #000000; stroke-width: 2.0;" x1="445.5" x2="445.5" y1="12.7451" y2="654.5889"/><line style="stroke: #000000; stroke-width: 2.0;" x1="794" x2="794" y1="12.7451" y2="654.5889"/><!--MD5=[6c8e139a6f968a135bd95d304571e839]
@startuml
|va-created|
start

-> Receive notification
from CVA;
if (VA status is ACTIVE) then (yes)
:Update VA's status
from PENDING to ACTIVE;
note left
Should only affect VA with
PENDING status to maintain
idempotency
end note
:Publish event to
va-activated;
-[#black,dotted]->
else (no)
stop
endif

|va-created|

|va-activated|
if (VA status is ACTIVE) then (yes)
:Check blacklist name
(assess risk score);
note right
Should be no issue
with idempotency,
but as alternative
can also check
the record first if the
risk score is attached
already
end note

:Update VA's risk score;

:Publish event to
va-risk-scored;
stop

else (no)
stop

endif


|va-activated|
@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 GMT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.9+11-Ubuntu-0ubuntu1
Operating System: Linux
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>